TabLib
.csv, .tsv, .xlsx, .xls, .json, .yaml, .ods, 

Template
.txt, .html, .xml, .pdf, .docx

https://python-docx.readthedocs.org/en/latest/#api-documentation
https://docs.djangoproject.com/en/dev/topics/templates/

<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Migraines.ics</title>

    <style type="text/css">
    * { 
        border:none;
        margin:0;
        padding:0;
    }

    body {
    	font-family: sans-serif;
    	margin: 20px;
    }

    .event{
    	margin: 10px 0px;
    }

    .event > div > span{
    	min-width: 100px;
    	display: inline-block;
    }
    </style>

</head>
<body>
	<h1>Events</h1>

	<div class="event">
		<div>
			<span>Summary:</span>Migraine
		</div>
		<div>
			<span>Description: </span>Just finished Christmas in Banstead back in Blackheath about to head up to Worksop.  Had eaten and drank lots over past couple of days, also slept well.
		</div>
		<div>
			<span>Start: </span>26/07/2010
		</div>
		<div>
			<span>End: </span>26/07/2010
		</div>
	</div>
</body>
</html>


var pattern = /\/download\/([0-9a-z]+)\/([0-9a-zA-Z\^\&\'\@\{\}\[\]\,\$\=\!\-\#\(\)\.\%\+\~\_ ]+)/g

var matches = pattern.exec(link)

if (matches != null){
	var hash = matches[1];
	var filename = matches[2];
	
	var downloadId = hash + "_" + filename;
}

from google.appengine.api import memcache


class download_progress(webapp2.RequestHandler):
	def get(self):
		download_id = self.request.get('downloadId')
	
		data = memcache.get(download_id)
		
		retry = True
		
		start_time = time.time()
		
		while (data or retry) and time.time() - start_time < 60:
			data = memcache.get(download_id)
			retry = False
			time.sleep(0.5)
			
		if data:
			logging.warning('Timeout waiting for: ' + download_id) 
			
		self.response.status = 200


download_id = file_hash + '_' + filename + '.' + extension

memcache.add(download_id, 'Downloading', 120)

memcache.delete(download_id)



